<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="style.css" />
  <title>Our Story 2025</title>
</head>

<body>
<!-- 1. Аудиоплеер (он будет невидимым) -->
  <audio id="background-music" loop autoplay muted>
    <source src="audio.mp3" type="audio/mpeg">
    Ваш браузер не поддерживает аудио.
  </audio>

  <!-- 2. Кнопка для управления звуком -->
  <div id="music-toggle">
    <!-- Иконка "звук выключен" (видна по умолчанию) -->
    <svg class="icon-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="28" height="28" fill="white"><path d="M3 9v6h4l5 5V4L7 9H3zm13.59 3L15 10.41 16.41 9 18 10.59 19.59 9 21 10.41 19.41 12 21 13.59 19.59 15 18 13.41 16.41 15 15 13.59z"/></svg>
    <!-- Иконка "звук включен" (скрыта по умолчанию) -->
    <svg class="icon-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="28" height="28" fill="white" style="display:none;"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
  </div>

  <div id="stars"></div>
  <div id="stars2"></div>
  <div id="stars3"></div>

  <div class="flipbook">

    <!-- ВАРИАНТ 1: Только картинка на весь лист -->  
    <div class="page-full-image flex-center-col">
      <img src="images/p1.png" alt="Full page Charmandar" class="img-shadow rounded border-black" style="width:90%;height:95%;object-fit:cover;">
    </div>

    <!-- ВАРИАНТ 1: Только картинка на весь лист -->  
    <div class="page-full-image flex-center-col">
      <video autoplay muted loop playsinline class="img-shadow rounded border-black" style="width:90%;height:95%;object-fit:cover;">
        <source src="images/bsky.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </div>
    
    <!-- ВАРИАНТ 3: Фото сверху, текст снизу -->
    <div class="page-text-bottom flex-center-col" >
      <img src="images/p2.jpg" alt="Первая встреча" class="img-shadow rounded">
      <h1 class="main-title">Первая встреча</h1>
      <span class="subtitle">Все началось неожиданно... <br/>
          Мы встретились в игре просто случаино в подземелье на сервере.<br/>
          Но в этот момент началась история, которую я никогда не забуду.</span>
    </div>

    <!-- ВАРИАНТ 2: Текст сверху, фото снизу -->
    <div class="page-text-top flex-center-col">
        <h1 class="main-title">Игра, в которой всё началось</h1>
        <span class="subtitle">В игре мы стали больше, чем игроками. <br/>
          Мы были командой. Мы были ближе.<br/>
          Смех, поддержка, победы и та самая свадьба в игре…</span>
        <div class="image-container img-shadow rounded">
          <img src="images/p3_.jpg" alt="Игра, в которой всё началось" class="rounded">
        </div>
    </div>
    
    <!-- ВАРИАНТ 4: Две Фото сверху, текст снизу -->
    <div class="page-text-bottom flex-center-col">
      <div class="image-container img-shadow rounded image-row">
          <img src="images/p4.jpg" alt="Свадьба в игре" class="rounded">
          <img src="images/p5_.jpg" alt="Свадьба в игре" class="rounded">
      </div>
      <h1 class="main-title">Свадьба в игре</h1>
      <span class="subtitle">Наша игровая свадьба самыи неожиданныи, но такой милыи момент.<br/>
          Даже виртуальные кольца могут согреть сердце,<br/>
          если ты рядом со мнои.</span>
    </div>

    <!-- ВАРИАНТ 3: Фото сверху, текст снизу -->
    <div class="page-text-bottom flex-center-col" >
      <img src="images/p6.png" alt="Telegram и первые разговоры" class="img-shadow rounded">
      <h1 class="main-title">Telegram и первые разговоры</h1>
      <span class="subtitle">Телеграм стал мостом между нашими мирами.<br/>
          Каждыи стикер, сообщение, аудио и видео как шаг навстречу.<br/>
          С каждым днем я чувствовал тебя все ближе…</span>
    </div>

    <!-- ВАРИАНТ 2: Текст сверху, фото снизу -->
    <div class="page-text-top flex-center-col">
        <h1 class="main-title">Звонки</h1>
        <span class="subtitle">Звонки, в которых голос стал родным.<br/>
          Просто слышать тебя уже счастье.<br/>
          Готов часами слушать твои голос…</span>
        <div class="image-container img-shadow rounded">
          <img src="images/p12.png" alt="Звонки" class="rounded">
        </div>
    </div>

        <!-- ВАРИАНТ 4: Две Фото сверху, текст снизу -->
    <div class="page-text-bottom flex-center-col">
      <div class="image-container img-shadow rounded image-row">
          <img src="images/p9.jpg" alt="Совместный фильм" class="rounded">
          <img src="images/p10.jpg" alt="Совместный фильм" class="rounded">
      </div>
      <h1 class="main-title">Совместный фильм</h1>
      <span class="subtitle">Фильм и мы вдвоем.<br/>
          Хоть и по разные стороны экрана,<br/>
          мы пережывали вместе, чувствовали вместе.<br/>
          Это было как настоящее свидание.</span>
    </div>

    <!-- ВАРИАНТ 3: Фото сверху, текст снизу -->
    <div class="page-text-bottom flex-center-col" >
      <img src="images/p13.png" alt="Фото" class="img-shadow rounded">
      <h1 class="main-title">Фото</h1>
      <span class="subtitle">Твои фото как луч света.<br/>
          Греют своим теплом.<br/>
          Смотрю на них и улыбаюсь.<br/>
          Потому что на этих снимках самая красивая, прекрасная, добрая, нежная…</span>
    </div>

    <!-- ВАРИАНТ 4: Три фото по диагонали -->
    <div class="page-diagonal-photos">
      <img src="images/i2.jpg" alt="Фото" class="img-shadow rounded">
      <img src="images/i3.jpg" alt="Фото" class="img-shadow rounded">
      <img src="images/i1.jpg" alt="Фото" class="img-shadow rounded">
    </div>


    <!-- ВАРИАНТ 3: Фото сверху, текст снизу -->
    <div class="page-text-bottom flex-center-col" >
      <img src="images/p9.png" alt="Видеозвонки" class="img-shadow rounded">
      <h1 class="main-title">Видеозвонки</h1>
      <span class="subtitle">Твое лицо на экране как это чудо.<br/>
          Улыбка, взгляд, голос…<br/>
          Эти моменты я храню в сердце.</span>
    </div>

    <!-- ВАРИАНТ 2: Текст сверху, фото снизу -->
    <div class="page-text-top flex-center-col">
        <h1 class="main-title">Стихи</h1>
        <span class="subtitle">Иногда эмоции не помешаются в слова... <br/>
          Поэтому я писал стихи...<br/>
          Простые, искренние, от сердца...</span>
        <div class="image-container img-shadow rounded">
          <img src="images/p14.png" alt="Стихи" class="rounded">
        </div>
    </div>

    <!-- ВАРИАНТ 3: Фото сверху, текст снизу -->
    <div class="page-text-bottom flex-center-col" >
      <img src="images/p17.png" alt="Благодарность" class="img-shadow rounded">
      <h1 class="main-title">Благодарность</h1>
      <span class="subtitle">Спасибо тебе.<br/>
          За каждое доброе утро.<br/>
          За поддержку. За то, что ты есть.<br/>
          Я счастлив, что ты вошла в мою жизнь.</span>
    </div>

    <!-- ВАРИАНТ 2: Текст сверху, фото снизу -->
    <div class="page-text-top flex-center-col">
        <h1 class="main-title">Прошлое и настоящее</h1>
        <span class="subtitle">Сколько всего мы уже прошли... <br/>
          А ведь началось все с игры.<br/>
          Сегодня 6 месяцев.<br/>
          И я бы прошел это все сначала если бы знал, что наиду тебя.</span>
        <div class="image-container img-shadow rounded with-bg" style="width:100%;">
          <div id="countdown" class="main-title"></div>
          <div class="butterfly-container">
            <img src="images/b1.webp" alt="Прошлое и настоящее" class="img gif butterfly">
          </div>
        </div>
    </div>

        <!-- ВАРИАНТ 2: Текст сверху, фото снизу -->
    <div class="page-text-top flex-center-col">
        <h1 class="main-title">Мечты</h1>
        <span class="subtitle">Иногда я закрываю глаза и представляю...<br/>
          Что мы не по ту сторону экрана.<br/>
          Что я держу тебя за руку.</span>
        <div class="image-container img-shadow rounded">
          <img src="images/p15.png" alt="Мечты" class="rounded">
        </div>
    </div>

    <div class="page-text-bottom flex-center-col" >
      <img src="images/p16.png" alt="Самый важный человек" class="img-shadow rounded">
      <h1 class="main-title">Самыи важныи человек</h1>
      <span class="subtitle">Ты стала частью моеи жизни.<br/>
          С тобои я могу быть настоящим.<br/>
          Ты причина моеи улыбки :)</span>
    </div>

    <!-- ВАРИАНТ 5: Фото сверху, текст снизу -->
    <div class="page-text-bottom flex-center-col page-auto">
      <h1 class="main-title">Wait please...</h1>
      <!-- Этот контейнер нужен для точного позиционирования курсора -->
      <div class="typewriter-container">
        <span id="typewriter-text"></span>
        <span id="typewriter-cursor"></span>
      </div>
    </div>

    <!-- ВАРИАНТ 6: Второй блок с текстом -->
    <div class="page-text-bottom flex-center-col page-auto2">
      <h1 class="main-title">Wait please...</h1>
      <!-- Контейнер для второго эффекта пишущей машинки -->
      <div class="typewriter-container">
        <span id="typewriter-text2"></span>  <!-- ИЗМЕНЕНО ID -->
        <span id="typewriter-cursor2"></span> <!-- ИЗМЕНЕНО ID -->
      </div>
    </div>

</div>

  <script src="jquery.js"></script>
  <script src="turn.js"></script>
  <script>
    $(document).ready(function() {
    const flipbook = $('.flipbook');

    function enableAudioOnFirstInteraction() {
    const audio = document.getElementById('background-music');
    const musicToggle = document.getElementById('music-toggle');
    const iconOn = musicToggle.querySelector('.icon-on');
    const iconOff = musicToggle.querySelector('.icon-off');

    // Если музыка уже включена, ничего не делаем
    if (!audio.muted) {
      document.body.removeEventListener('click', enableAudioOnFirstInteraction);
      document.body.removeEventListener('touchstart', enableAudioOnFirstInteraction);
      return;
    }
    
    musicToggle.addEventListener('click', function() {
      if (audio.muted) {
        // Если звук был выключен (muted), то мы его ВКЛЮЧАЕМ
        audio.muted = false;
        iconOn.style.display = 'block';
        iconOff.style.display = 'none';
      } else {
        // Выключаем звук
        audio.muted = true;
        iconOn.style.display = 'none';
        iconOff.style.display = 'block';
      }
    });
    // =======================================================

    // Флаги, чтобы каждая анимация запустилась только один раз
    let typewriter1Started = false;
    let typewriter2Started = false;

    // Пытаемся включить звук
    audio.muted = false;
    let promise = audio.play();

    if (promise !== undefined) {
      promise.then(_ => {
        // Звук успешно включен
        iconOn.style.display = 'block';
        iconOff.style.display = 'none';
        // Удаляем слушатели, чтобы они не срабатывали повторно
        document.body.removeEventListener('click', enableAudioOnFirstInteraction);
        document.body.removeEventListener('touchstart', enableAudioOnFirstInteraction);
      }).catch(error => {
        // Если что-то пошло не так, возвращаем в исходное состояние
        console.error("Audio play was interrupted.", error);
        audio.muted = true;
      });
    }
  }

  // Добавляем слушатели на первое взаимодействие
  document.body.addEventListener('click', enableAudioOnFirstInteraction);
  document.body.addEventListener('touchstart', enableAudioOnFirstInteraction); // для мобильных

    // Флаги, чтобы каждая анимация запустилась только один раз
    let typewriter1Started = false;
    let typewriter2Started = false;

    function setupFlipbook() {
      const width = flipbook.width();
      const height = flipbook.height();

      if (flipbook.data().turn) {
        flipbook.turn('size', width, height);
        return;
      }

      flipbook.turn({
        width: width,
        height: height,
        display: 'single',
        autoCenter: true,
        gradients: true,
        acceleration: true,
        turnCorners: 'bl,br'
      });
    }

    setupFlipbook();

    $(window).on('resize', function() {
      setTimeout(setupFlipbook, 100);
    });

    // --- ДОБАВЛЕНА ЛОГИКА ДЛЯ ПИШУЩЕЙ МАШИНКИ ---
    const typewriterPage1 = 17; // Первая страница
    const typewriterPage2 = 18; // Вторая (новая) страница

    flipbook.on('turned', function (event, page, view) {
      // Запускаем первую анимацию
      if (page === typewriterPage1 && !typewriter1Started) {
        startTypewriter1();
        typewriter1Started = true;
      }
      // Запускаем вторую анимацию
      if (page === typewriterPage2 && !typewriter2Started) {
        startTypewriter2();
        typewriter2Started = true;
      }
    });
  });

// --- Функция для ПЕРВОЙ пишущей машинки ---
  function startTypewriter1() {
    const text = `I don’t know what will happen tomorrow.\nI don’t know what will happen in a week.\nI don’t know what will happen in a year.\nBut I know for sure you are my sunshine forever ☀️.`;
    const textContainer = document.getElementById("typewriter-text");
    const cursor = document.getElementById("typewriter-cursor");
    typeAnimation(text, textContainer, cursor);
  }

  // --- Функция для ВТОРОЙ пишущей машинки ---
  function startTypewriter2() {
    // !!! ЗАМЕНИТЕ ЭТОТ ТЕКСТ НА СВОЙ !!!
    const text = `Я не всегда попадаю онлайн в Telegram.\nно это вовсе не значит, что я не думаю о тебе.\nМоя улыбка появляется каждый раз,\nкогда я слышу твои голос.\nА сердце начинает сильно стучать,\nкогда я вижу тебя.\nМои чувства к тебе не утихли…\nОни стали только сильнее. 💙\n`;
    const textContainer = document.getElementById("typewriter-text2");
    const cursor = document.getElementById("typewriter-cursor2");
    typeAnimation(text, textContainer, cursor);
  }
  
  // --- Общая функция для анимации (чтобы не дублировать код) ---
  function typeAnimation(text, textContainer, cursor) {
    let i = 0;
    textContainer.innerHTML = '';
    function type() {
      if (i < text.length) {
        const char = text[i];
        const charSpan = document.createElement('span');
        if (char === '\n') {
          charSpan.innerHTML = '<br>';
        } else {
          charSpan.textContent = char;
        }
        textContainer.appendChild(charSpan);
        const rect = charSpan.getBoundingClientRect();
        const containerRect = textContainer.getBoundingClientRect();
        cursor.style.left = (rect.right - containerRect.left) + 'px';
        cursor.style.top = (rect.top - containerRect.top) + 'px';
        i++;
        setTimeout(type, 70);
      }
    }
    type();
  }

  // Таймер: сколько времени прошло с 20.01.2025
  function updateCountdown() {
    const now = new Date();
    const localTimeStr = now.toLocaleString('ru-RU', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
    const target = new Date(Date.UTC(2025, 0, 20, 0, 0, 0));
    let diff = now - target;
    if (diff < 0) diff = 0;
    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
    const minutes = Math.floor((diff / (1000 * 60)) % 60);
    const seconds = Math.floor((diff / 1000) % 60);
    document.getElementById('countdown').textContent =
      `С 20.01.2025 прошло: ${days} дней ${hours} ч ${minutes} мин ${seconds} сек)`;
  }
  setInterval(updateCountdown, 1000);
  updateCountdown();
  </script>

</body>

</html>